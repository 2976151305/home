<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="../layui/css/layui.css">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../layui/css/layui.mobile.css">
  <script src="../js/jquery-1.11.3.min.js"></script>
  <script src="../js/mian.js"></script>
  <!--[if lt IE 9]>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
  <title>先装修后付款</title>
</head>

<body>
  <header id="header"></header>

  <div class="banner">
    <img class="cover-img" style="height: 400px;">
  </div>
  <main class="layui-container">
    <div class="block-pt">
      <div class="textC">
        <h1 class="block-title layui-inline">申请条件</h1>
        <div class="apply-conditions layui-col-space30">
          <div class="condition-item layui-col-lg3">
            <span>持有二代身份证的中国居民（不含港澳台）</span>
          </div>
          <div class="condition-item layui-col-lg3">
            <span>年龄介于：23---50周岁</span>
          </div>
          <div class="condition-item layui-col-lg3">
            <span>本人名下有房产</span>
          </div>
          <div class="condition-item layui-col-lg3">
            <span>贷款金额不超过20W</span>
          </div>
        </div>
        <button class="layui-inline layui-btn layui-btn-primary apply-btn">立即申请</button>
      </div>
    </div>
    <div class="block-pt">
      <div class="textC">
        <h1 class="block-title layui-inline">业务特点</h1>
      </div>
    </div>
    <div class="block-pt">
      <div class="textC">
        <h1 class="block-title layui-inline">常见问题</h1>
      </div>
    </div>
  </main>

  <footer id="footer"></footer>

  <script src="../layui/layui.js"></script>
  <script src="../js/distpicker.data.min.js"></script>
  <script src="../js/distpicker.min.js"></script>
  <script>
    layui.use(['element', 'layer'], function () {
      var element = layui.element
      var layer = layui.layer
      var $apply = $('.apply-btn')
      var content = `
      <h3 class="textC">请告诉我们以下信息方便我们联系到您</h3>
      <div class="layui-form">
        <div class="layui-form-item">
          <label class="layui-form-label">联系人</label>
          <div class="layui-input-block">
            <input type="text" name="name" id="name" autocomplete="off" class="layui-input">
          </div>
        </div>
        <div class="layui-form-item">
          <label class="layui-form-label">手机号码</label>
          <div class="layui-input-block">
            <input type="tel" maxlength="11" name="phone" id="phone" autocomplete="off" class="layui-input">
          </div>
        </div>
        <div class="layui-form-item">
          <label class="layui-form-label">所在地</label>
          <div class="layui-input-block layui-col-space10" id="distpicker" data-toggle="distpicker">
            <select name="province" lay-verify="required" id="province" class="layui-input layui-col-lg6"></select>
            <select name="city" lay-verify="required" id="city" class="layui-input layui-col-lg6"></select>
          </div>
        </div>
      </div>
      `.trim()
      $apply.on('click', function () {
        layer.open({
          title: false,
          content,
          area: ['390px', '370px'],
          shadeClose: true,
          closeBtn: false,
          shade: .5,
          move: false,
          btn: '提交',
          btnAlign: 'c',
          success: function () {
            $("#distpicker").distpicker()
          },
          yes: function (index, layero) {
            var name = $('#name').val()
            var phone = $('#phone').val()
            var city = $('#province').val() + $('#city').val()
            var data = { name, phone, city }
            console.log(data)
            active.query('/decorate/users/api/apply/loans/', data, 'POST').then(res => {
              if (res.code === 'success') {
                layer.msg('提交成功')
              } else{
                layer.msg(res.msg)
              }
            }).catch(err => new Error(err))
            // $.ajax({
            //   url: BASEURL + '/decorate/users/api/apply/loans/',
            //   data,
            //   method: 'POST',
            //   dataType: 'json',
            //   headers: {
            //     'Content-Type': 'application/x-www-form-urlencoded'
            //   },
            //   success: function(res) {
            //     console.log(res)
            //     if(res.code === 'success'){
            //       layer.msg('提交成功')
            //       layer.close(index)
            //     }
            //   },
            //   fail: function(err){
            //     new Error(err)
            //   }
            // })
          }
        })
      })
    })
  </script>
</body>

</html>